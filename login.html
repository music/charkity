<html>
<body>
Email: <input type="text" id="newEmail"></input>
</br>
Password: <input type="password" id="newPassword"></input>
<button onclick="createUser()">Create User</button>
<br>
<br>
Email: <input type="text" id="loginEmail"></input>
</br>
Password: <input type="password" id="loginPassword"></input>
<button onclick="loginUser()">Login User</button>


<script src="https://www.gstatic.com/firebasejs/4.12.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.12.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.12.0/firebase-database.js"></script>
<!-- <script src="https://www.gstatic.com/firebasejs/4.12.0/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.12.0/firebase-messaging.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.12.0/firebase-functions.js"></script> -->
<script src="bundle.js"></script>

<script>

var userCreated = 0; 
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyCXak386757EoosAb2vII2svD9hnUyasUs",
    authDomain: "charkity-2db46.firebaseapp.com",
    databaseURL: "https://charkity-2db46.firebaseio.com",
    projectId: "charkity-2db46",
    storageBucket: "charkity-2db46.appspot.com",
    messagingSenderId: "88663340604"
  };
  firebase.initializeApp(config);

function createUser(){
	// alert(document.getElementById('newEmail').value);
  firebase.auth().createUserWithEmailAndPassword(document.getElementById('newEmail').value, document.getElementById('newPassword').value).catch(function(error) {
    // Handle Errors here.
    var errorCode = error.code;
    var errorMessage = error.message;
    if(errorCode){
    	alert(errorMessage);
    }
    // console.log(errorCode);
    // console.log(errorMessage);
    // ...
  });
userCreated = 1;
}

function loginUser(){
  firebase.auth().signInWithEmailAndPassword(document.getElementById('loginEmail').value, document.getElementById('loginPassword').value).catch(function(error) {
    // Handle Errors here.
    var errorCode = error.code;
    var errorMessage = error.message;
    if(errorCode){
      alert(errorCode);
    }else{
    	alert
    	// window.location = "index.html";
      // ...
    }
  });
}


	firebase.auth().onAuthStateChanged(function(user) {
  if (user) {
    // User is signed in.
    // alert("signed in");
    if(userCreated == 1){
      var seed = bip39.generateMnemonic();
  var keys = arkJS.crypto.getKeys(seed);
  var address = arkJS.crypto.getAddress(keys.publicKey, 0x1E);

  firebase.database().ref('users/' + user.uid).set({
    seed: seed,
    address: address,
    publicKey : keys.publicKey
  }, function(error){
 if(error){
    console.log(error);
 }
 else{
    window.location = "index.html";
  }

});
}
// window.location.href = "index.html";
  } else {
  	alert(user);
    // User is signed out.
    // ...
  }
});


</script>
</body>
</html>